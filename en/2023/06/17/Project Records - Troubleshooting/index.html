<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Project Records — Troubleshooting | Hongjin's Blog</title><meta name="author" content="hongjin lu"><meta name="copyright" content="hongjin lu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Here I will record some insightful bugs I encountered in enterprise development, as well as troubleshooting for code BatchUpdateException: ORA-12899Oracle SQL table design problem Bug DescriptionThe p">
<meta property="og:type" content="article">
<meta property="og:title" content="Project Records — Troubleshooting">
<meta property="og:url" content="http://lh728.github.io/en/2023/06/17/Project%20Records%20-%20Troubleshooting/index.html">
<meta property="og:site_name" content="Hongjin's Blog">
<meta property="og:description" content="Here I will record some insightful bugs I encountered in enterprise development, as well as troubleshooting for code BatchUpdateException: ORA-12899Oracle SQL table design problem Bug DescriptionThe p">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://lh728.github.io/en/img/avatar.png">
<meta property="article:published_time" content="2023-06-17T03:46:45.099Z">
<meta property="article:modified_time" content="2023-06-26T13:01:25.169Z">
<meta property="article:author" content="hongjin lu">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Vue">
<meta property="article:tag" content="SQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://lh728.github.io/en/img/avatar.png"><link rel="shortcut icon" href="/en/img/favicon.png"><link rel="canonical" href="http://lh728.github.io/en/2023/06/17/Project%20Records%20-%20Troubleshooting/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/en/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/en/',
  algolia: undefined,
  localSearch: {"path":"/en/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Project Records — Troubleshooting',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-06-26 21:01:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/modify.css"><link rel="stylesheet" href="/static/css/custom.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/en/rss2.xml" title="Hongjin's Blog" type="application/rss+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = 'hidden';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}

preloader.initLoading()
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/en/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home Page</span></a></div><div class="menus_item"><a class="site-page" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="http://thellu.com/"><i class="fa-fw fa fa-language"></i><span> 中文</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/en/" title="Hongjin's Blog"><span class="site-name">Hongjin's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home Page</span></a></div><div class="menus_item"><a class="site-page" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="http://thellu.com/"><i class="fa-fw fa fa-language"></i><span> 中文</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Project Records — Troubleshooting</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-06-17T03:46:45.099Z" title="Created 2023-06-17 11:46:45">2023-06-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-06-26T13:01:25.169Z" title="Updated 2023-06-26 21:01:25">2023-06-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Project-Records/">Project Records</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">1.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>8min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Project Records — Troubleshooting"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/en/2023/06/17/Project%20Records%20-%20Troubleshooting/#post-comment"><span class="gitalk-comment-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Here I will record some insightful bugs I encountered in enterprise development, as well as troubleshooting for code</p>
<h2 id="BatchUpdateException-ORA-12899"><a href="#BatchUpdateException-ORA-12899" class="headerlink" title="BatchUpdateException: ORA-12899"></a>BatchUpdateException: ORA-12899</h2><p><strong>Oracle SQL table design problem</strong></p>
<h3 id="Bug-Description"><a href="#Bug-Description" class="headerlink" title="Bug Description"></a>Bug Description</h3><p>The product manager asked me to check for a bug that occurred in an unknown environment (I didn’t ask whether it was a development, test, or formal environment). The front-end failed to upload excel to update data, and it prompted “Database exception, please contact the administrator”.</p>
<h3 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h3><p>Obviously, this is usually an error reported by the backend, so I reproduced the error according to the process, and then directly looked at the result of the idea, and the idea reported an error:</p>
<blockquote>
<p>Exception in thread “main” java.sql.BatchUpdateException: ORA-12899: value too large for column “xx” (actual: 208, maximum: 200)</p>
</blockquote>
<p>According to the literal meaning of such an error, it seems that the data exceeds the byte limit of a certain field in sql, so through our <a target="_blank" rel="noopener" href="https://thellu.com/en/2023/06/12/Project%20Records%20-%20Enterprise%20Requirement/">Project Record-Enterprise Requirements</a> blog, “<strong>Frontend Code Mapping Backend</strong> <strong>Code</strong>“ method, finds the corresponding back-end code, and then finds the corresponding entity class to see which data table it links to. This helps us directly locate the problem table in the company’s huge database.</p>
<p>After locating the problem table, click “Design Table” in Navicat, I can directly see the byte limit of each field, and then correspond to the content in the excel file that reported the error, I can easily find the corresponding limit of 200 bytes offending column. But the strange thing is that if a Chinese code occupies 2 bytes, I personally feel that the number of bytes of data in this column in this excel file does not reach the standard of 208.</p>
<p>Then query:</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> userenv(<span class="hljs-string">'language'</span>) <span class="hljs-keyword">from</span> dual;<br></code></pre></td></tr></tbody></table></figure>

<p>The result is <em><code>AMERICAN_AMERICA.AL32UTF8</code></em></p>
<p>This shows that our Oracle database uses <em><code>AMERICAN_AMERICA.AL32UTF8</code></em> as the character encoding set. This UTF-8 encoding set occupies three bytes for a Chinese character. In order to verify our guess, query:</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> lengthb(<span class="hljs-string">'xx'</span>) <span class="hljs-keyword">from</span> dual;<br></code></pre></td></tr></tbody></table></figure>

<p>xx is the data content that exceeds the byte limit, and the answer is 208 bytes, which proves that I am correct.</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><ul>
<li>Change the character encoding set in oracle sql to <em><code>SIMPLIFIED CHINESE_CHINA.AL32UTF8</code></em>, such a Chinese only occupies two bytes. But obviously this method may affect other tables</li>
<li>It is not required to upload too much content corresponding to the data column of excel</li>
<li>Expand the byte limit of the field</li>
</ul>
<hr>
<h2 id="Json-default-parsing-method"><a href="#Json-default-parsing-method" class="headerlink" title="Json default parsing method"></a>Json default parsing method</h2><h3 id="Bug-Description-1"><a href="#Bug-Description-1" class="headerlink" title="Bug Description"></a>Bug Description</h3><p>A very normal operation: I call a method on the backend and return a List result set to the frontend. We know that this result set is placed in a List with a lot of json data at the front end.</p>
<p>The data I’m going to return has these columns:</p>
<ul>
<li>DESCR - Department name</li>
<li>userId - ID</li>
<li>name - name</li>
<li>jobType - job type</li>
</ul>
<p>Among them, userId, name, and jobType are displayed normally on the front end, and the data is obtained, but there is no data show in the column DESCR:</p>
<table>
<thead>
<tr>
<th align="center">DESCR</th>
<th align="center">userId</th>
<th align="center">name</th>
<th align="center">jobType</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center">1</td>
<td align="center">a</td>
<td align="center">A</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">2</td>
<td align="center">b</td>
<td align="center">B</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">3</td>
<td align="center">c</td>
<td align="center">C</td>
</tr>
</tbody></table>
<p>After looking at the backend, debug at the breakpoint found that the data was passed normally. The column DESCR has a value, but I don’t know why it is not displayed on the frontend.</p>
<h3 id="Troubleshooting-1"><a href="#Troubleshooting-1" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h3><p>Debug at the break point on the front end, and find that the Json data passed looks like this:</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">{</span>dESCR<span class="hljs-punctuation">:</span>...<span class="hljs-punctuation">,</span>userId<span class="hljs-punctuation">:</span>'<span class="hljs-number">1</span>'<span class="hljs-punctuation">,</span>name<span class="hljs-punctuation">:</span>'a'<span class="hljs-punctuation">,</span>jobType<span class="hljs-punctuation">:</span>'A'<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br><span class="hljs-punctuation">{</span>dESCR<span class="hljs-punctuation">:</span>...<span class="hljs-punctuation">,</span>userId<span class="hljs-punctuation">:</span>'<span class="hljs-number">2</span>'<span class="hljs-punctuation">,</span>name<span class="hljs-punctuation">:</span>'b'<span class="hljs-punctuation">,</span>jobType<span class="hljs-punctuation">:</span>'B'<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br>...<br></code></pre></td></tr></tbody></table></figure>

<p>This is strange, why is the first letter of the DESCR column lowercase?</p>
<p>It was later discovered that not only the first letter of the DESCR column is lowercased, but in fact the first letter of each column with a capitalized first letter will be lowercased, because they are originally lowercased here, so they cannot be seen here.</p>
<p>The reason for this is to discuss the principle behind it because all JSON implementations are inseparable from HttpMessageConverter, which is a message conversion tool that mainly implements two functions:</p>
<ul>
<li>Serialize the object returned by the server into a JSON string</li>
<li>Deserialize the JSON string sent from the front end into a Java object</li>
</ul>
<p>Relevant dependencies have been automatically imported for us in the dependency package generated by SpringBoot. SpringMVC automatically configures <strong>Jackson</strong> and Gson’s HttpMessageConverter.</p>
<p>By default, our company’s project uses Jackson to parse the Json code. During the serialization process, Jackson will automatically convert fields’ first letter beginning with uppercase to lowercase.</p>
<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h3><ul>
<li>Add <em><code>@JsonFormat</code></em> or <em><code>@JsonProperty</code></em> annotations to unchanging properties that need to preserve case</li>
<li>Annotate the class with <em><code>@JsonAutoDetect(getterVisibility=JsonAutoDetect.Visibility.NONE)</code></em></li>
</ul>
<hr>
<h2 id="EsayPoi-parsing-Excel-picture-null-pointer"><a href="#EsayPoi-parsing-Excel-picture-null-pointer" class="headerlink" title="EsayPoi parsing Excel picture null pointer"></a>EsayPoi parsing Excel picture null pointer</h2><h3 id="Bug-Description-2"><a href="#Bug-Description-2" class="headerlink" title="Bug Description"></a>Bug Description</h3><p>A very interesting bug, I have been troubled here for a day.</p>
<p>Now there are two Excel files that are almost exactly the same. When I import and parse, one Excel file will report a null pointer, and the other file will be parsed and imported normally.</p>
<p>The business logic here is:</p>
<ul>
<li>The business downloads the Excel template first</li>
<li>The business enters the information they want to import according to the template, one of which is image information column</li>
<li>The picture information is pasted into Excel by the business</li>
<li>Finally, the business clicks Import, parses Excel, and imports the information into the database</li>
</ul>
<p>This bug is encountered by the business in this process. The business has two almost identical Excel files, and their text information is exactly the same. The only difference is that the pictures are different.</p>
<p>Moreover, even if the picture in the Excel file that can be parsed and imported normally is pasted into the Excel file with problems, a null pointer exception will still be reported, which is very strange.</p>
<h3 id="Troubleshooting-2"><a href="#Troubleshooting-2" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h3><p>At first I thought that the picture might cover other cells, so I tried to stretch the picture, but it didn’t work.</p>
<p>Then carefully study the back-end code and find that this piece is parsed by calling the <em><code>importExcelMore</code></em> method of the <em><code>ExcelImportUtil</code></em> class of EasyPoi API. So I continued to drill down and found that more precisely, the problem occurred when calling the <em><code>getSheetPictures07</code></em> method of EasyPoi API’s <em><code>PoiPublicUtil</code></em> class.</p>
<p>To be more precise, it is an error reported when executing the code shown below in this placement:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">...<br>	pic.getPreferredSize()<br>...<br></code></pre></td></tr></tbody></table></figure>

<p>Break point debug , here needs an anchor’s cell1 attribute and cell2 attribute.</p>
<p>Then the cell2 attribute here is empty, so a null pointer is reported.</p>
<p>Knowing the origin of the error, now go back and find out why the cell2 attribute is null? Where is this attribute constructed?</p>
<p>After a long search, I finally found that it was constructed in the <em><code>getAchorFromParent</code></em> method of Poi API’s <em><code>XSSFDrawing</code></em> class.</p>
<p>The method looks like this:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> XSSFAnchor <span class="hljs-title function_">getAnchorFromParent</span><span class="hljs-params">(XmlObject obj)</span> {<br>  <span class="hljs-type">XSSFAnchor</span> <span class="hljs-variable">anchor</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  <span class="hljs-type">XmlObject</span> <span class="hljs-variable">parentXbean</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  <span class="hljs-type">XmlCursor</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> obj.newCursor();<br>  <span class="hljs-keyword">if</span> (cursor.toParent()) {<br>    parentXbean = cursor.getObject();<br>  }<br>  cursor.dispose();<br>  <span class="hljs-keyword">if</span> (parentXbean != <span class="hljs-literal">null</span>) {<br>    <span class="hljs-keyword">if</span> (parentXbean <span class="hljs-keyword">instanceof</span> CTTwoCellAnchor) {<br>      <span class="hljs-type">CTTwoCellAnchor</span> <span class="hljs-variable">ct</span> <span class="hljs-operator">=</span> (CTTwoCellAnchor) parentXbean;<br>      anchor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XSSFClientAnchor</span>(ct.getFrom(), ct.getTo());<br>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parentXbean <span class="hljs-keyword">instanceof</span> CTOneCellAnchor) {<br>      <span class="hljs-type">CTOneCellAnchor</span> <span class="hljs-variable">ct</span> <span class="hljs-operator">=</span> (CTOneCellAnchor) parentXbean;<br>      anchor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XSSFClientAnchor</span>(getSheet(), ct.getFrom(), ct.getExt());<br>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parentXbean <span class="hljs-keyword">instanceof</span> CTAbsoluteAnchor) {<br>      <span class="hljs-type">CTAbsoluteAnchor</span> <span class="hljs-variable">ct</span> <span class="hljs-operator">=</span> (CTAbsoluteAnchor) parentXbean;<br>      anchor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XSSFClientAnchor</span>(getSheet(), ct.getPos(), ct.getExt());<br>    }<br>  }<br>  <span class="hljs-keyword">return</span> anchor;<br>}<br><br></code></pre></td></tr></tbody></table></figure>

<p>Don’t fully understand the code, just look at the middle here, where the <code>parentXbean</code> will create the anchor and its cell2 properties.</p>
<p>When we use breakpoint debugging, we will find that if we import a problematic Excel, we will go to this judgment: <em><code>parentXbean instanceof CTOneCellAnchor</code></em></p>
<p>And normal Excel will go to this judgment: <em><code>parentXbean instanceof CTTtwoCellAnchor</code></em></p>
<p>Then, the problem lies in CTTwoCellAnchor and CTOneCellAnchor. </p>
<p>What are these two classes? Apparently something to do with pictures - thanks to Greg Woolsey for explaining it right here. refer to:</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://bz.apache.org/bugzilla/show_bug.cgi?id=61203">https://bz.apache.org/bugzilla/show_bug.cgi?id=61203</a></p>
</blockquote>
<p>Therefore, <strong>CTTwoCellAnchor means that Move and size with cells</strong>; <strong>CTOneCellAnchor means that Move but don’t size with cells</strong>.</p>
<p>Then, this corresponds to the picture properties in Excel:</p>
<p><img src="/en/images/Projects_Records/%E9%A1%B9%E7%9B%AE%E8%AE%B0%E5%BD%95%E2%80%94%E2%80%94%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5(1).png" alt="Project Records"></p>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h3><ul>
<li>At this point, the problem is solved, you only need to modify the picture properties in Excel. So far, the problem has been solved. As for the deeper reason, due to the tight schedule of the project, there is no time to delve into it. Friends who understand are welcome to leave a message in the comment area</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="http://lh728.github.io/en">hongjin lu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://lh728.github.io/en/2023/06/17/Project%20Records%20-%20Troubleshooting/">http://lh728.github.io/en/2023/06/17/Project%20Records%20-%20Troubleshooting/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en/tags/Java/">Java</a><a class="post-meta__tags" href="/en/tags/Vue/">Vue</a><a class="post-meta__tags" href="/en/tags/SQL/">SQL</a></div><div class="post_share"><div class="social-share" data-image="/en/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/en/2023/06/27/How%20to%20debug%20springboot%20scheduled%20scheduling%20tasks/" title="How to debug spring boot scheduling tasks"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">How to debug spring boot scheduling tasks</div></div></a></div><div class="next-post pull-right"><a href="/en/2023/06/12/Project%20Records%20-%20Enterprise%20Requirement/" title="Project Records - Enterprise Requirement"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Project Records - Enterprise Requirement</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/en/2023/06/12/Project%20Records%20-%20Enterprise%20Requirement/" title="Project Records - Enterprise Requirement"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-12</div><div class="title">Project Records - Enterprise Requirement</div></div></a></div><div><a href="/en/2023/06/27/How%20to%20debug%20springboot%20scheduled%20scheduling%20tasks/" title="How to debug spring boot scheduling tasks"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-27</div><div class="title">How to debug spring boot scheduling tasks</div></div></a></div><div><a href="/en/2023/06/06/Intranet%20projects%20avoid%20pitfall/" title="Intranet projects avoid pitfall"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-06</div><div class="title">Intranet projects avoid pitfall</div></div></a></div><div><a href="/en/2023/06/03/Initialization%20of%20Java%20virtual%20machine%20class%20loading/" title="Initialization of Java virtual machine class loading"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-03</div><div class="title">Initialization of Java virtual machine class loading</div></div></a></div><div><a href="/en/2023/06/02/Why%20anonymous%20inner%20class%20parameters%20must%20be%20final/" title="Why anonymous inner class parameters must be final"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-02</div><div class="title">Why anonymous inner class parameters must be final</div></div></a></div><div><a href="/en/2023/05/19/The%20actual%20process%20of%20class%20initialization/" title="The actual process of class initialization"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-19</div><div class="title">The actual process of class initialization</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/en/img/avatar.png" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">hongjin lu</div><div class="author-info__description">Code Lover</div></div><div class="card-info-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lh728"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/lh728" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:holu@tcd.ie" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/hongjinlu/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: ;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#BatchUpdateException-ORA-12899"><span class="toc-number">1.</span> <span class="toc-text">BatchUpdateException: ORA-12899</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bug-Description"><span class="toc-number">1.1.</span> <span class="toc-text">Bug Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Troubleshooting"><span class="toc-number">1.2.</span> <span class="toc-text">Troubleshooting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution"><span class="toc-number">1.3.</span> <span class="toc-text">Solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Json-default-parsing-method"><span class="toc-number">2.</span> <span class="toc-text">Json default parsing method</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bug-Description-1"><span class="toc-number">2.1.</span> <span class="toc-text">Bug Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Troubleshooting-1"><span class="toc-number">2.2.</span> <span class="toc-text">Troubleshooting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1"><span class="toc-number">2.3.</span> <span class="toc-text">Solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EsayPoi-parsing-Excel-picture-null-pointer"><span class="toc-number">3.</span> <span class="toc-text">EsayPoi parsing Excel picture null pointer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bug-Description-2"><span class="toc-number">3.1.</span> <span class="toc-text">Bug Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Troubleshooting-2"><span class="toc-number">3.2.</span> <span class="toc-text">Troubleshooting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2"><span class="toc-number">3.3.</span> <span class="toc-text">Solution</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en/2023/06/27/How%20to%20debug%20springboot%20scheduled%20scheduling%20tasks/" title="How to debug spring boot scheduling tasks">How to debug spring boot scheduling tasks</a><time datetime="2023-06-27T12:52:17.686Z" title="Created 2023-06-27 20:52:17">2023-06-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en/2023/06/17/Project%20Records%20-%20Troubleshooting/" title="Project Records — Troubleshooting">Project Records — Troubleshooting</a><time datetime="2023-06-17T03:46:45.099Z" title="Created 2023-06-17 11:46:45">2023-06-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en/2023/06/12/Project%20Records%20-%20Enterprise%20Requirement/" title="Project Records - Enterprise Requirement">Project Records - Enterprise Requirement</a><time datetime="2023-06-12T13:30:42.179Z" title="Created 2023-06-12 21:30:42">2023-06-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en/2023/06/06/Intranet%20projects%20avoid%20pitfall/" title="Intranet projects avoid pitfall">Intranet projects avoid pitfall</a><time datetime="2023-06-06T11:56:34.722Z" title="Created 2023-06-06 19:56:34">2023-06-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en/2023/06/03/Initialization%20of%20Java%20virtual%20machine%20class%20loading/" title="Initialization of Java virtual machine class loading">Initialization of Java virtual machine class loading</a><time datetime="2023-06-03T06:00:41.517Z" title="Created 2023-06-03 14:00:41">2023-06-03</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">©2023 By hongjin lu</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="http://thellu.com/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en/js/utils.js"></script><script src="/en/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '14434470b1b606fb600b',
      clientSecret: 'ba10ef9f1658154646e0c5531ce5493a872e611b',
      repo: 'blog',
      owner: 'lh728',
      admin: ['lh728'],
      id: '5d9fd7168cb63ded8fc5d2b7410828c1',
      updateCountCallback: commentCount
    },{"language":"en"}))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.textContent= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/en/js/search/local-search.js"></script></div></div></body></html>